@model ApplicationUser
@{
	ViewData["Title"] = "Register";
}

<div class="container my-5">
	<div class="row justify-content-center">
		<div class="col-lg-6 col-md-8">
			<div class="card shadow border-0 rounded-4 overflow-hidden">
				<div class="card-header bg-primary text-white text-center py-4 rounded-top-4">
					<div class="d-flex flex-column align-items-center">
						<i class="bi bi-person-plus display-4 mb-2"></i>
						<h2 class="fw-bold mb-0">Create Your Account</h2>
						<p class="text-light small mt-1 opacity-75">Join us and manage users effortlessly</p>
					</div>
				</div>

				<div class="card-body p-4 bg-light">
					<div class="text-danger small" asp-validation-summary="ModelOnly"></div>
					<form  asp-controller="Account" asp-action="Register" method="post" novalidate>
						<!-- Username -->
						<div class="mb-3">
							<label asp-for="UserName" class="form-label fw-semibold text-secondary">
								<i class="bi bi-person me-1"></i> Username
							</label>
							<input asp-for="UserName" class="form-control form-control rounded-3 shadow-sm" placeholder="e.g. Eslam Elsaadany" />
							<span asp-validation-for="UserName" class="text-danger small"></span>
						</div>

						<!-- Email -->
						<div class="mb-3">
							<label asp-for="Email" class="form-label fw-semibold text-secondary">
								<i class="bi bi-envelope me-1"></i> Email Address
							</label>
							<input asp-for="Email" class="form-control form-control rounded-3 shadow-sm" placeholder="name@example.com" />
							<span asp-validation-for="Email" class="text-danger small"></span>
						</div>

						<!-- Age -->
						<div class="mb-3">
							<label asp-for="Age" class="form-label fw-semibold text-secondary">
								<i class="bi bi-calendar-date me-1"></i> Age
							</label>
							<input asp-for="Age" class="form-control form-control rounded-3 shadow-sm" placeholder="Enter your age" />
							<span asp-validation-for="Age" class="text-danger small"></span>
						</div>

						<!-- Password -->
						<div class="mb-3 position-relative">
							<label asp-for="PasswordHash" class="form-label fw-semibold text-secondary">
								<i class="bi bi-lock me-1"></i> Password
							</label>
							<div class="input-group input-group shadow-sm">
								<input asp-for="PasswordHash" type="password" class="form-control rounded-start-3" id="passwordField" placeholder="Enter a strong password" />
								<button type="button" class="btn btn-outline-secondary rounded-end-3" id="togglePassword">
									<i class="bi bi-eye"></i>
								</button>
							</div>

							<div class="progress mt-2" style="height: 6px;">
								<div id="passwordStrengthBar" class="progress-bar bg-danger" style="width: 0%; transition: width 0.4s ease;"></div>
							</div>
							<small id="passwordStrengthLabel" class="fw-semibold small text-muted"></small>

							<span asp-validation-for="PasswordHash" class="text-danger small"></span>
						</div>

						<!-- Confirm Password -->
						<div class="mb-4 position-relative">
							<label asp-for="ConfirmPassword" class="form-label fw-semibold text-secondary">
								<i class="bi bi-lock-fill me-1"></i> Confirm Password
							</label>
							<div class="input-group input-group shadow-sm">
								<input asp-for="ConfirmPassword" type="password" class="form-control rounded-start-3" id="confirmPasswordField" placeholder="Re-enter password" />
								<button type="button" class="btn btn-outline-secondary rounded-end-3" id="toggleConfirmPassword">
									<i class="bi bi-eye"></i>
								</button>
							</div>
							<span asp-validation-for="ConfirmPassword" class="text-danger small"></span>
						</div>

						<!-- Actions -->
						<div class="d-flex justify-content-between align-items-center mt-4">
							<a asp-action="Login" asp-controller="Account" class="btn btn-outline-secondary px-4 rounded-3 shadow-sm">
								<i class="bi bi-arrow-left-circle me-1"></i> Back to Login
							</a>
							<button type="submit" class="btn btn-primary px-5 rounded-3 shadow-sm">
								<i class="bi bi-person-check-fill me-1"></i> Register
							</button>
						</div>
					</form>
				</div>

				<div class="card-footer bg-white text-center py-3">
					<small class="text-muted">
						Already have an account?
						<a asp-action="Login" asp-controller="Account" class="text-decoration-none fw-semibold text-primary">
							Sign in here
						</a>
					</small>
				</div>
			</div>
		</div>
	</div>
</div>

@section Scripts {
	<partial name="_ValidationScriptsPartial" />

	<!-- Bootstrap Icons -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

	<script>
		const passwordField = document.getElementById("passwordField");
		const confirmPasswordField = document.getElementById("confirmPasswordField");
		const togglePassword = document.getElementById("togglePassword");
		const toggleConfirmPassword = document.getElementById("toggleConfirmPassword");
		const strengthBar = document.getElementById("passwordStrengthBar");
		const strengthLabel = document.getElementById("passwordStrengthLabel");

		function toggleVisibility(field, button) {
			const type = field.type === "password" ? "text" : "password";
			field.type = type;
			button.innerHTML = type === "password"
				? '<i class="bi bi-eye"></i>'
				: '<i class="bi bi-eye-slash"></i>';
		}

		togglePassword.addEventListener("click", () => toggleVisibility(passwordField, togglePassword));
		toggleConfirmPassword.addEventListener("click", () => toggleVisibility(confirmPasswordField, toggleConfirmPassword));

		passwordField.addEventListener("input", () => {
			const password = passwordField.value;
			let score = 0;

			if (password.length >= 8) score++;
			if (/[A-Z]/.test(password)) score++;
			if (/[a-z]/.test(password)) score++;
			if (/[0-9]/.test(password)) score++;
			if (/[^A-Za-z0-9]/.test(password)) score++;

			let strength = { width: "0%", color: "bg-danger", label: "" };

			switch (score) {
				case 1:
				case 2:
					strength = { width: "40%", color: "bg-danger", label: "Weak" };
					break;
				case 3:
					strength = { width: "70%", color: "bg-warning", label: "Medium" };
					break;
				case 4:
				case 5:
					strength = { width: "100%", color: "bg-success", label: "Strong" };
					break;
			}

			strengthBar.style.width = strength.width;
			strengthBar.className = `progress-bar ${strength.color}`;
			strengthLabel.textContent = strength.label;
			strengthLabel.style.color =
				strength.color === "bg-warning" ? "orange" :
					strength.color === "bg-success" ? "green" : "red";
		});
	</script>
}
